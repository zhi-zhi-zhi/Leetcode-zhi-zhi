function countExcellentPairs(nums: number[], k: number): number {
  const n = nums.length;
  let res = 0;

  const set = new Set<string>();
  for (let i = 0; i < n; i++) {
    for (let j = i; j >= 0; j--) {
      const orCount = getDigits(nums[i] | nums[j])
      const andCount = getDigits(nums[i] & nums[j])
      if (orCount + andCount >= k) {
        set.add(`${nums[i]}_${nums[j]}`)
        if (nums[i] !== nums[j])
          set.add(`${nums[j]}_${nums[i]}`)
      }
    }
  }

  return set.size;

  function getDigits(num: number): number {
    let ans = 0
    while (num) {
      ans++
      num = num & (num - 1)
    }
    return ans
  }
}

console.log(countExcellentPairs([835629415,351309815,49150408,943491888,565190881,784785515,458580154,207976256,942484694,697232505,188827225,156179351,193949760,673998253,920811184,739819067,262386502,61474923,823890246,446545661,932182661,489077116,398648949,804215177,641386725,468061280,391714556,518327608,833813488,872128342,451707603,797347717,687966342,289928645,812217175,117574021,116458425,565175823,534798601,569069066,256648979,3360160,517690889,677329317,357767280,484940662,518991046,84579889,44731802,602535313,238382072,185358688,452290343,542506190,340791995,665252970,18650036,539521347,217395658,287256199,601896037,272257052,470841104,546547868,663048997,943167962,709026412,477122484,885497648,353755521,780897246,974312218,728182742,440789537,645723885,202667926,823521415,639872180,140773772,701959296,587999709,643459241,19426777,76053504,671656322,152534925,403092631,242756161,523141030,478788719,687012042,403331697,817847711,694417846,927503620,549668716,701228864,635382593,828500583,880117113,985964777,41526031,993508283,347585248,908082841,10746465,96543456,295869831,525386003,706158109,497117262,730870952,568732289,97467132,796692957,835953392,149133075,614954571,365715517,324925003,602462721,460051926,667289509,118274902,155711345,598854209,5624408,708038316,805783754,766924994,401504942,378651519,665115713,966549894,564851293,251439401,641791314,290796458,297903933,829953908,510336153,354327665,387214930,610709442,439302118,990879440,922876711,643104945,948087420,569810280,543782194,388618387,858402648,842162508,447375995,95705843,424455917,421561601,683601400,152672298,877792307,523391354,135697487,292545490,586469668,65767081,274329862,546489685,991641854,866833882,81183858,559772772,954299792,92914991,461877368,998775415,427528424,685934025,303008170,177747989,348313825,839026280,62517375,631344643,509628245,224525946,582564996,590658808,660454210,648178279,492536250,653730772,741887785,985513307,42356539,34341467,544580132,534835068,207212082,976138490,5995545,655392037,148943619,738496222,855286520,392564405,736004685,216146313,452762872,832330968,434548010,492515094,794044111,11759765,510969626,240969014,677197503,257017368,335655727,186306901,606459305,509922125,844833735,902328181,207309038,762897102,973684990,749838104,444065649,91437006,545460985,208678073,302150387,946985350,83452192,960966020,160108484,238381840,304697114,314557453,218288075,240509172,248583017,488287950,807211779,975528813,319269722,595953074,926026059,356124133,797753635,984023727,186452264,853828795,961440499,34392440,938900405,448454966,704512458,786383446,727860136,771966757,374813870,178585805,666917069,598235733,110853719,346454685,232521839,59891119,863140206,135366085,496780464,594109689,127744834,358721617,320248376,438419780,980464694,863321865,931429268,607716420,960500455,777107880,910764280,151625096,210932031,8180350,979914741,702058336,526831408,20175394,983726967,575292695,943428784,499594524,754881269,356073225,65165125,675620381,348310498,172642714,350316938,818929021,58261682,120494960,233968949,723063749,739233677,816152855,964316135,224015760,745578535,392242510,748271050,318821826,440283885,391210169,674429360,347141902,26761591,979507855,681633538,988080847,402091459,269271146,719848217,431463813,710981319,165587257,259690673,464332614,359815144,28699427,974415705,4907453,629300179,359402898,568117601,380770481,196084713,569280334,77909213,445101234,650268673,747518754,963454702,204469069,956592250,616478624,51010079,282036823,356573371,188190411,593900175,356768563,384703297,485797791,941017973,35659698,42186893,887299819,398258445,743261490,901379606,30552474,623043529,440822866,607593574,672124241,246295452,662737335,490810466,960169995,272833094,890710818,924808967,632221913,608738623,558097829,629299252,409112683,670295215,330718106,550025211,565657888,62078083,575698975,918276090,577933515,255282390,564336465,72520347,762123203,108214446,535652473,229003628,495910211,421573322,149676732,334769408,15244010,431314783,945180901,261144605,438280017,779496948,374201083,389185007,672927192,981695795,822653520,424519115,991680806,644400044,342350003,128892869,205573629,658104437,251619455,198470209,482949789,313330277,370591817,253126333,990251354,696429955,523289402,152875942,176346133,158913532,455525840,743897159,279167701,582132502,105278446,666464404,136739717,614726728,663665214,172778045,218953872,915651011,532395556,277257881,27611209,405983563,497832883,301963527,809190530,177744411,374181116,4466954,534954800,906246966,661618426,474709338,202061968,634261798,827802421,548339584,329849859,200083000,629059091,384208141,482441448,959428442,185822215,269371439,298114786,964923340,706457715,312305052,253454993,219905173,760447705,841373359,302057417,138541526,783591548,293500273,62882957,515278386,963062971,913267380,70817260,402912806,702716905,316112819,226307348,52239093,527555872,365133762,709779751,733981647,744110410,323152781,686735906,299456442,674724246,646881504,338931094,108437610,110006515,401136701,491908211,678489490,615359879,970102731,480978963,907710506,760633651,89895908,899236465,882307168,898112951,605187842,932627489,903123506,526935135,756873973,24687011,19526303,253495245,145249399,394998617,286860643,884137661,545363184,214297056,88989193,223064210,667345898,582343815,431687605,183806581,854373221,639051076,611283271,672274802,917443896,969213901,237363510,97166004,149321750,212004135,263461840,346161476,962887546,492973255,186204539,9281632,122923698,269336135,148061495,827889849,450836771,185235139,279116702,311908707,552150169,877877112,224884312,578921260,564390180,166859776,771735713,700636918,903774715,154240097,123953790,687896059,721609661,202614853,648963992,600802908,256454512,425152502,180022666,849821689,531324036,552604658,957133452,972156622,85649391,220398151,945279752,66073315,532976767,911368539,445976212,833040157,632017223,837896744,94486394,273023670,603105538,135198786,613650578,526336736,232794885,494725791,302345103,259747600,881344993,10417765,778899049,309938463,657318029,226890287,497364839,241036746,908928223,456558415,790674619,575819552,20868411,801768212,180279246,272322030,697562128,140304126,564955540,470970475,422804160,95716270,402767584,999792722,219892407,278342766,481960379,200897897,645469520,643207036,214766613,186544185,895741195,690243848,484365619,697100555,407409220,487802333,553218682,726652777,579001881,183720768,354793106,969294856,737847144,434299562,533054304,180760275,542956121,65385398,603887518,872768004,366890132,421206506,629830550,178600744,312846197,321965691,343269899,139487587,182407005,27336716,787378644,160231302,107081673,148623111,814496627,873573177,115352442,466164677,668954991,801596975,878971700,402843575,465386599,783331597,495914933,739107904,504765473,941894839,557965851,479925501,343999889,530359819,74053119,158164402,950731224,860404403,285297377,53201088,871880341,301742276,36320442,752628632,283243130,239723537,945808152,921705873,160827156,535144243,599805533,526916636,363818581,334076626,17359818,723637143,524415350,384293588,694974213,2754112,970560127,446607913,821959199,91285352,142780443,305465671,811362636,755082655,96206420,602372050,799375479,455050792,494053984,74951340,658975928,245214674,447083352,845412858,435092189,776844621,115298049,308179672,335740130,407874911,740687735,147971981,509351206,704169617,733465832,831107789,518768959,293039505,626626022,838610188,15318486,181949233,695851269,126400952,562401575,940110987,637681157,897449274,79070741,241616879,446892909,7157614,164403591,611953335], 3));
